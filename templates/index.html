<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subtitlarr</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <h1>ðŸ’¬ Subtitlarr</h1>
        
        <div class="card">
            <h2 id="config-header" class="collapsible-header">
                <span class="toggle-arrow">â–¼</span>
                Configuration
            </h2>
            
            <div id="config-content" class="collapsible-content">
                <div id="config-form">
                    <label>Search Paths:</label>
                    <div id="paths-container">
                        {% for path in config.search_paths %}
                        <div class="input-group"><input type="text" value="{{ path }}" class="path-input"><button class="btn-delete">&times;</button></div>
                        {% endfor %}
                    </div>
                    <button id="add-path" class="btn-add">Add Path</button>
                    <hr>
                    <label>Languages (2-letter codes):</label>
                    <div id="langs-container">
                        {% for lang in config.languages %}
                        <div class="input-group"><input type="text" value="{{ lang }}" class="lang-input"><button class="btn-delete">&times;</button></div>
                        {% endfor %}
                    </div>
                    <button id="add-lang" class="btn-add">Add Language</button>
                    <hr>
                    <label>Download Scheduler</label>
                    <div class="form-switch">
                        <label for="schedule-enabled">Enable automatic download:</label>
                        <input type="checkbox" id="schedule-enabled" class="schedule-input" {% if config.schedule_enabled %}checked{% endif %}>
                    </div>
                    <div class="input-group">
                        <label for="schedule-interval">Run every (minutes):</label>
                        <input type="number" id="schedule-interval" class="schedule-input" value="{{ config.schedule_interval_minutes }}">
                    </div>
                    <hr>
                    <label>Provider credentials</label>
                    <div class="input-group">
                        <label for="opensubtitles-key">OpenSubtitles API Key:</label>
                        <input type="password" id="opensubtitles-key" value="{{ config.credentials.opensubtitles.api_key }}">
                    </div>
                    <div class="input-group">
                        <label for="addic7ed-user">Addic7ed Username:</label>
                        <input type="text" id="addic7ed-user" value="{{ config.credentials.addic7ed.username }}">
                    </div>
                    <div class="input-group">
                        <label for="addic7ed-pass">Addic7ed Password:</label>
                        <input type="password" id="addic7ed-pass" value="{{ config.credentials.addic7ed.password }}">
                    </div>
                </div>
                <div class="actions">
                    <button id="save-config">Save Changes</button>
                </div>
            </div>
        </div>

        <div class="actions">
            <button id="scanBtn">Scan Status</button>
            <button id="downloadBtn">Download Missing</button>
        </div>

        <div class="card">
            <h2>Status & Logs</h2>
            <div id="progress-container" class="hidden">
                <progress id="progress-bar" value="0" max="100"></progress>
                <span id="progress-label">0/0</span>
            </div>
            <pre id="log-output">{% for log in logs %}{{ log }}
{% endfor %}</pre>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>